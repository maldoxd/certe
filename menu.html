<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Certe Sandwichs</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet"> 
    <link href="css/printcss.css" rel="stylesheet"> 

    <link rel="stylesheet" href="css/kendo.common.min.css" />
    <link rel="stylesheet" href="css/kendo.default.min.css" />
    <link rel="stylesheet" href="css/kendo.default.mobile.min.css" />
    <script src="js/jquery.min.js"></script> 
    <script src="js/kendo.all.min.js"></script>
</head>

<!-- Custom CSS -->
<style>
    body {
        
        /* Required padding for .navbar-fixed-top. Remove if using .navbar-static-top. Change if height of navigation changes. */
    }
 @media print  
{
    div{
        page-break-inside: avoid;
    }
}
    .col-xs-6
    { 
    font-size: 18px;
padding-bottom: 200px;
    }
</style>


</head>

<body>



    <!-- Page Content -->
    <div class="container">

        <div class="row">
            <div class="col-lg-12 text-center">
                <h1>Sandwich Template</h1>
                <p class="lead">Selecciona dia</p>
                <select id="DaySelect">
  <option value="Monday">Monday</option>
  <option value="Tuesday" selected="">Tuesday</option> 
  <option value="Wednesday">Wednesday</option> 
  <option value="Thursday">Thursday</option> 
  <option value="Friday">Friday</option>  
</select>
                <input id="Check" type="button" value="CHECK">
                <div id="example"></div>

                <div id="grid2"></div>
            </div>
        </div>
        <!-- /.row -->
        <input id="print" type="button" hidden="" value="print">
    </div>
    <!-- /.container -->
    <div id="grid" class="col-md-12 row line"></div>
    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
<script src="https://npmcdn.com/dropbox/dist/Dropbox-sdk.min.js"></script>
<script src="js/global.js"></script>
<script>
    var htContents;
    var container = document.getElementById('example');
    $("#grid2").kendoGrid({
        dataSource: {
            batch: true,
            schema: {
                model: {
                    fields: {
                        qty: {},
                        stage: {}, 
                        dressed: { type: "boolean" },
                          ceramic: { type: "boolean" },
                    }
                }
            },
        },
        toolbar: ["create"],
        columns: [

            {
                field: "Cantidad",
                title: "Cantidad",
                width: "120px"
            }, {
                field: "Stage",
                title: "Stage",
                width: "120px"
            }, {
                field: "dressed",
                title: "Undressed",
                width: "40px"
            }, {
                field: "ceramic",
                title: "Ceramic",
                width: "40px"
            }
        ],
        editable: true
    });

    var data = new Array();

    var arrayName = new Array();
    $("#Check").click(function() {
        var list = $("#grid");
        list.empty();
        var day = $("#DaySelect").val();
        var daySelection = Monday;
        var dayDist = MondayDist;
        switch (day) {
            case 'Tuesday':
                daySelection = Tuesday;
                dayDist = TuesdayDist;
                break;
            case 'Wednesday':
                daySelection = Wednesday;
                dayDist = WednesdayDist;
                break;
            case 'Thursday':
                daySelection = Thursday;
                dayDist = ThursdayDist;
                break;
            case 'Friday':
                daySelection = Friday;
                dayDist = FridayDist;
        }
        addDay(daySelection, JSON.parse(JSON.stringify(dayDist)), day);

    });
    //Recorre y agrega los sandwichs elegidos
    function addDay(daySand, Daydist, day) {
        var grid = $("#grid2").data("kendoGrid");
        var _arrayData = grid.dataSource.data();
        //se recorre el grid
        for (var i = 0; i < _arrayData.length; i++) {
            var qty = _arrayData[i].Cantidad;
            var DaySand = JSON.parse(JSON.stringify(daySand));
            var data = new Array();
            //se filtran las lineas vacias
            if (qty != null) {
                list = $("#grid");
                list.append('<div class="col-xs-6 .always-pba  .avoid-pbi  .always-page-break-after quad"></div>')
                list = list.find('div').last();
                var Undressed = _arrayData[i].dressed==true?" UNDRESSED":"";
                var Ceramic = _arrayData[i].dressed==true?" CERAMIC":"";
                var text = (_arrayData[i].Stage!=null?_arrayData[i].Stage: "" )+Undressed+ Ceramic;
                list.append('<ul><b>' + qty + 'pp ' + day + ': ' + text + '</b></ul>');
                list = list.find('ul').last();
                var total = 0;
                if (qty < 7) {
                    DaySand[0].splice(Math.floor((Math.random() * 2) - 1), 1);
                    DaySand[2].splice(Math.floor((Math.random() * 2) - 1), 1); 
                }
                //se empieza a recorrer la lista de sandwichs
                for (var j = 0; j < DaySand.length; j++) {
                    var dist = 0; //distribucion
                    var countCat= 0;//numero de sand en esta categoria
                   
                    for (var k = 0; k < DaySand[j].length; k++) {
                         //menos sandwichs que la lista
    
                    

                               var ran = Math.floor((Math.random() * 3) - 1);
                               console.log(ran)
                               if((ran==1))
                                    {
                                        
                                          dist =  Math.floor((qty * Daydist[j] / DaySand[j].length / 100)) ;
                                            }
                                         else
                                             
                                         { dist = Math.round((qty * Daydist[j] / DaySand[j].length / 100)) ;
                                         }
                                         
                                    
                                
                        
                                if (j == DaySand.length -1) {//los ultimos que son la lista de poultry se le ponen el resto
                                  if (k==0)
                                    dist = Math.round((qty - total) / 2);
                                  else
                                    dist=qty-total;
                                }
                        if (dist==0){
                            dist=1;
                        
                        }countCat += dist;
                        total += dist;
                        data.push([DaySand[j][k],dist]);
                    }

                }
                var oultrycheck = ( data[data.length-1][1] + data[data.length-2][1]);
             
             // if ((oultrycheck<qty*45/100)&&(qty>6))
             //    {
             //        var less =( qty*45/100)-oultrycheck ;
             //        var alt=Math.floor((Math.random() *3));
             //        for(var d =0;d<less;d++){
             //            if (data[alt][1]>1){
                            
                        
             //                data[alt][1] -=1;
                       
             //            data [data.length-(alt+1)][1]+=1;
             //            }
             //            else
             //                d--;
                    
             //            alt =Math.floor((Math.random() *4))//=alt==0?1:0;
                        
             //        } 
             //    }
                for (var l = 0; l < data.length; l++) {
                    list.append('<ol>' + data[l][0] + ': ' + data[l][1] + '</ol>');

                }
            }

            $("#print").show();
        }

    }
    function shuffle(array) {
    let counter = array.length;

    // While there are elements in the array
    while (counter > 0) {
        // Pick a random index
        let index = Math.floor(Math.random() * counter);

        // Decrease counter by 1
        counter--;

        // And swap the last element with it
        let temp = array[counter];
        array[counter] = array[index];
        array[index] = temp;
    }

    return array;
}
    $("#print").click(function() {

        $(".container").hide();
        $("#grid").show;
        window.print();
        $(".container").show();
    });
</script>